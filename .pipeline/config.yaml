pipelines:
  outlink:
    blubberfile: outlink/blubber.yaml
    stages:
      - name: run-test
        build: test
        run: true
      - name: production
        build: production

  outlink-publish:
    blubberfile: outlink/blubber.yaml
    stages:
      - name: publish
        build: production
        publish:
          image:
            name: '${setup.project}-outlink'
            tags: [stable]

  outlink-transformer:
    blubberfile: outlink/transformer.yaml
    stages:
      - name: run-test
        build: test
        run: true
      - name: production
        build: production

  outlink-transformer-publish:
    blubberfile: outlink/transformer.yaml
    stages:
      - name: publish
        build: production
        publish:
          image:
            name: '${setup.project}-outlink-transformer'
            tags: [stable]

  nsfw:
    stages:
      - name: run-test
        build: test
        run: true
      - name: production
        build: production

  nsfw-publish:
    blubberfile: nsfw/blubber.yaml
    stages:
      - name: publish
        build: production
        publish:
          image:
            name: '${setup.project}-nsfw'
            tags: [stable]

  revertrisk:
    stages:
      - name: run-test
        build: test
        run: true
      - name: production
        build: production

  revertrisk-publish:
    blubberfile: revertrisk/blubber.yaml
    stages:
      - name: publish
        build: production
        publish:
          image:
            name: '${setup.project}-revertrisk'
            tag: ${setup.timestamp}-language-agnostic
            tags: [stable]

  revscoring:
    stages:
      - name: run-test
        build: test
        run: true
      - name: production
        build: production

  revscoring-publish:
    blubberfile: revscoring/blubber.yaml
    stages:
      - name: publish
        build: production
        publish:
          image:
            name: '${setup.project}-revscoring'
            tags: [stable]
